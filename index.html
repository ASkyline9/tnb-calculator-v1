<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#2563eb">
<title>TNB Electricity Cost Calculator V1</title>
<style>
    body { font-family: Arial, sans-serif; margin: 24px; }
    .wrap { max-width: 420px; }
    input, button { padding: 10px; margin: 6px 0; width: 100%; box-sizing: border-box; }
    .result { margin-top: 10px; padding: 10px; border: 1px solid #eee; }
    .note { font-size: 12px; color: #555; }
    </style>
</head>
<body>
<div class="wrap">
  <h1>TNB Electricity Cost Calculator V1</h1>
  <p class="muted">Voltage is fixed at <b>240 V</b>. TNB rate defaults to <b>RM0.27/kWh</b> (editable).</p>
  <label for="amp">Amp (A)</label>
  <input id="amp" type="number" step="0.01" placeholder="e.g. 0.08">
  <label for="minutes">Minutes</label>
  <input id="minutes" type="number" step="1" placeholder="e.g. 12">
  <div class="row">
    <div>
      <label for="rate">TNB Rate (RM/kWh)</label>
      <input id="rate" type="number" step="0.01" value="0.27">
    </div>
    <div>
      <label for="voltage">Voltage (fixed)</label>
      <input id="voltage" type="text" value="240 V" disabled>
    </div>
  </div>
  <button class="primary" id="calcBtn">Calculate</button>
  <div id="out" class="result" role="status" aria-live="polite"></div>
  <p class="note">After calculation, Amp and Minutes will clear; TNB Rate stays.</p>
  <p class="note">Install this app: open menu in your browser &raquo; <b>Add to Home screen</b>. It will work offline.</p>
</div>
<script>
if ('serviceWorker' in navigator) { navigator.serviceWorker.register('./sw.js'); }

function round(value, decimals) {
  const p = Math.pow(10, decimals);
  return Math.round((value + Number.EPSILON) * p) / p;
}

document.getElementById('calcBtn').addEventListener('click', function() {
  const amp = parseFloat(document.getElementById('amp').value);
  const minutes = parseFloat(document.getElementById('minutes').value);
  let rate = parseFloat(document.getElementById('rate').value);
  const voltage = 240; // fixed

  const out = document.getElementById('out');

  if (isNaN(amp) || isNaN(minutes)) {
    out.innerHTML = "âš  Please enter both Amp and Minutes.";
    return;
  }
  if (isNaN(rate) || rate <= 0) rate = 0.27;

  const hours = minutes / 60.0;
  const powerKW = (amp * voltage) / 1000.0;
  const energyKWh = powerKW * hours;
  const costRM = energyKWh * rate;

  const powerDisp = round(powerKW, 3).toFixed(3);
  const energyDisp = round(energyKWh, 3).toFixed(3);
  const costDisp = round(costRM, 2).toFixed(2);

  out.innerHTML = `<b>Power:</b> ${powerDisp} kW<br>
                   <b>Energy Used:</b> ${energyDisp} kWh<br>
                   <b>Cost:</b> RM${costDisp}`;

  document.getElementById('amp').value = "";
  document.getElementById('minutes').value = "";
});
</script>
</body>
</html>
